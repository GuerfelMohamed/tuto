<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Reactive Media Player</title><meta charset="utf8"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="stylesheet" href="/css/style.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/themes/prism.min.css"/><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-ocaml.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-clike.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-reason.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-javascript.min.js"></script><script src="/js/client.js"></script></head><body class="tuto 4.0 reactivemediaplayer"><div class="project-page"><div class="page-header"><p class="logo-ocsigen"><a href="/" class="ocsimore_phrasing_link"><img src="/img/ocsigen-white.svg" alt="Ocsigen"/></a>
</p><p class="logo-subproject">Doc
</p><ul class="mainmenu"><li class="mainmenu-home"><a href="/" class="ocsimore_phrasing_link">Home</a>
</li><li class="mainmenu-doc mainmenu-current"><a href="/tuto/6.2/manual/intro" class="ocsimore_phrasing_link">Doc</a>
</li><li><a href="/eliom/6.3/manual/intro" class="ocsimore_phrasing_link">Eliom</a>
</li><li><a href="/js_of_ocaml/3.1.0/manual/overview" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li><a href="/lwt/3.2.1/manual/manual" class="ocsimore_phrasing_link">Lwt</a>
</li><li><a href="/tyxml/4.1.0/manual/intro" class="ocsimore_phrasing_link">Tyxml</a>
</li><li><a href="/ocsigen-start/1.1.0/manual/intro" class="ocsimore_phrasing_link">Start</a>
</li></ul><div class="how-drawer"><input id="how-drawer-toggle" type="checkbox"/><label for="how-drawer-toggle" id="how-drawer-label"><span class="how-drawer-icon"></span></label><nav class="how-drawer-content"><ul class="drawermainmenu"><li class="drawermainmenu-home"><a href="/" class="ocsimore_phrasing_link">Home</a>
</li><li class="drawermainmenu-doc drawermainmenu-current"><a href="/tuto/6.2/manual/intro" class="ocsimore_phrasing_link">Doc</a>
</li><li class="drawermainmenu-project"><a href="/eliom/6.3/manual/intro" class="ocsimore_phrasing_link">Eliom</a>
</li><li class="drawermainmenu-project"><a href="/js_of_ocaml/3.1.0/manual/overview" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li class="drawermainmenu-project"><a href="/ocsigenserver/2.9/manual/quickstart" class="ocsimore_phrasing_link">Server</a>
</li><li class="drawermainmenu-project"><a href="/lwt/3.2.1/manual/manual" class="ocsimore_phrasing_link">Lwt</a>
</li><li class="drawermainmenu-project"><a href="/tyxml/4.1.0/manual/intro" class="ocsimore_phrasing_link">Tyxml</a>
</li><li class="drawermainmenu-project"><a href="/ocsigen-toolkit/1.1.0/manual/intro" class="ocsimore_phrasing_link">Toolkit</a>
</li><li class="drawermainmenu-project"><a href="/ocsigen-start/1.1.0/manual/intro" class="ocsimore_phrasing_link">Start</a>
</li><li class="drawermainmenu-page"><a href="/projects" class="ocsimore_phrasing_link">Other projects</a>
</li><li class="drawermainmenu-page"><a href="/papers" class="ocsimore_phrasing_link">Research papers</a>
</li><li class="drawermainmenu-page"><a href="/credits" class="ocsimore_phrasing_link">Who does Ocsigen?</a>
</li><li class="drawermainmenu-page"><a href="/blog" class="ocsimore_phrasing_link">Blog</a>
</li><li class="drawermainmenu-page"><a href="https://github.com/ocsigen" class="ocsimore_phrasing_link">Source code</a>
</li></ul><div class="how-doctree"><h1> Tutorial: Your first application</h1><h2><a href="/tuto/4.0/manual/intro" class="ocsimore_phrasing_link">Introduction. Ocsigen: the different projects</a></h2><h2><a href="/tuto/4.0/manual/application" class="ocsimore_phrasing_link">Client/server application</a></h2><h2><a href="/tuto/4.0/manual/interaction" class="ocsimore_phrasing_link">Service based Web programming</a></h2><h2><a href="/tuto/4.0/manual/misc" class="ocsimore_phrasing_link">Miscellaneous features</a></h2><h1> Examples: Learning by example</h1><h2><a href="/tuto/4.0/manual/chat" class="ocsimore_phrasing_link">Chat</a></h2><h1> Mini-tutorials: Some little examples</h1><h2><a href="/tuto/4.0/manual/basicwebsite" class="ocsimore_phrasing_link">A basic Web site in OCaml</a></h2><h2><a href="/tuto/4.0/manual/tutowidgets" class="ocsimore_phrasing_link">Eliom apps basics: writing client server widgets</a></h2><h2><a href="/tuto/4.0/manual/macaque" class="ocsimore_phrasing_link">MaCaQue: SQL queries</a></h2><h2><a href="/tuto/4.0/manual/custom-conf" class="ocsimore_phrasing_link">Custom configuration</a></h2><h2><a href="/tuto/4.0/manual/ocsipersist" class="ocsimore_phrasing_link">Light database</a></h2><h2><a href="/tuto/4.0/manual/pictures" class="ocsimore_phrasing_link">Download pictures</a></h2><h2><a href="/tuto/4.0/manual/music" class="ocsimore_phrasing_link">Playing music</a></h2><h2><a href="/tuto/4.0/manual/reactivemediaplayer" class="ocsimore_phrasing_link">Reactive media player</a></h2><h2><a href="/tuto/4.0/manual/hash-password" class="ocsimore_phrasing_link">Protecting passwords</a></h2><h2><a href="/tuto/4.0/manual/rest" class="ocsimore_phrasing_link">RESTful JSON API</a></h2><h1 class="howto"> HOW-TO</h1><h2> My first steps with Ocsigen</h2><h3><a href="/tuto/4.0/manual/how-to-install-ocsigen" class="ocsimore_phrasing_link">How to install Ocsigen</a></h3><h3><a href="/tuto/4.0/manual/how-to-make-hello-world-in-ocsigen" class="ocsimore_phrasing_link">How to make &quot;hello world&quot; in Ocsigen</a></h3><h3><a href="/tuto/4.0/manual/how-to-compile-my-ocsigen-pages" class="ocsimore_phrasing_link">How to compile my Ocsigen pages</a></h3><h3><a href="/tuto/4.0/manual/how-to-configure-and-launch-the-ocsigen-server" class="ocsimore_phrasing_link">How to configure and launch the Ocsigen Server</a></h3><h3><a href="/tuto/4.0/manual/how-does-a-page-s-source-code-look" class="ocsimore_phrasing_link">How does a client-server app source code look like?</a></h3><h2> How to put some elements in my page ?</h2><h3><a href="/tuto/4.0/manual/how-to-make-page-a-skeleton" class="ocsimore_phrasing_link">How to make a page skeleton</a></h3><h3><a href="/tuto/4.0/manual/how-to-use-get-parameters-or-parameters-in-the-url" class="ocsimore_phrasing_link">How to use GET parameters (parameters in the URL)</a></h3><h3><a href="/tuto/4.0/manual/how-to-add-css-stylesheet" class="ocsimore_phrasing_link">How to add CSS stylesheet</a></h3><h3><a href="/tuto/4.0/manual/how-to-add-a-javascript-script" class="ocsimore_phrasing_link">How to add a Javascript script</a></h3><h3><a href="/tuto/4.0/manual/how-to-add-a-favicon" class="ocsimore_phrasing_link">How to add a Favicon</a></h3><h3><a href="/tuto/4.0/manual/how-to-add-a-div" class="ocsimore_phrasing_link">How to add a div</a></h3><h3><a href="/tuto/4.0/manual/how-to-add-a-list" class="ocsimore_phrasing_link">How to add lists in pages?</a></h3><h3><a href="/tuto/4.0/manual/how-to-add-an-image" class="ocsimore_phrasing_link">How to add an image</a></h3><h3><a href="/tuto/4.0/manual/how-to-write-titles-and-paragraphs" class="ocsimore_phrasing_link">How to write titles and paragraphs</a></h3><h3><a href="/tuto/4.0/manual/how-to-set-and-id-classes-or-other-attributes-to-html-elements" class="ocsimore_phrasing_link">How to set and id, classes or other attributes to HTML elements</a></h3><h3><a href="/tuto/4.0/manual/how-to-add-a-select-or-other-form-element" class="ocsimore_phrasing_link">How to add select (or other form element)</a></h3><h3><a href="/tuto/4.0/manual/how-to-insert-raw-form-elements-not-belonging-to-a-form-towards-a-service" class="ocsimore_phrasing_link">How to insert &quot;raw&quot; form elements (not belonging to a form towards a service)</a></h3><h3><a href="/tuto/4.0/manual/how-to-make-responsive-css" class="ocsimore_phrasing_link">How to make responsive CSS</a></h3><h2> Services</h2><h3><a href="/tuto/4.0/manual/how-to-do-links-to-other-pages" class="ocsimore_phrasing_link">How to do links to other pages</a></h3><h3><a href="/tuto/4.0/manual/how-to-write-forms" class="ocsimore_phrasing_link">How to write forms</a></h3><h3><a href="/tuto/4.0/manual/how-to-register-a-service-that-decides-itself-what-to-send" class="ocsimore_phrasing_link">How to register a service that decides itself what to send</a></h3><h3><a href="/tuto/4.0/manual/how-to-create-link-to-a-current-page-without-knowing-its-url" class="ocsimore_phrasing_link">How to create link to a current page (without knowing its URL)</a></h3><h3><a href="/tuto/4.0/manual/how-to-create-form-wizard-sequence-of-pages-depending-on-data-entered-on-previous-ones" class="ocsimore_phrasing_link">How to create form wizard (sequence of pages depending on data entered on previous ones)</a></h3><h3><a href="/tuto/4.0/manual/how-to-write-a-json-service" class="ocsimore_phrasing_link">How to write a JSON service</a></h3><h3><a href="/tuto/4.0/manual/how-to-send-file-download" class="ocsimore_phrasing_link">How to send a file (download)</a></h3><h3><a href="/tuto/4.0/manual/how-to-send-file-upload" class="ocsimore_phrasing_link">How to send a file (upload)</a></h3><h2> Sessions</h2><h3><a href="/tuto/4.0/manual/how-to-register-session-data" class="ocsimore_phrasing_link">How to register session data</a></h3><h2> Js_of_ocaml</h2><h3><a href="/tuto/4.0/manual/how-to-attach-ocaml-values-to-dom-elements" class="ocsimore_phrasing_link">How to attach OCaml values to DOM elements</a></h3><h3><a href="/tuto/4.0/manual/how-to-know-whether-the-browser-window-has-the-focus-or-not" class="ocsimore_phrasing_link">How to know whether the browser window has the focus or not</a></h3><h3><a href="/tuto/4.0/manual/how-to-build-js-object" class="ocsimore_phrasing_link">How to build js object</a></h3><h3><a href="/tuto/4.0/manual/how-to-stop-default-behaviour-of-events" class="ocsimore_phrasing_link">How to stop default behaviour of events</a></h3><h3><a href="/tuto/4.0/manual/how-to-call-an-ocaml-function-from-js-code" class="ocsimore_phrasing_link">Howt to call an OCaml function from js code</a></h3><h2> Eliom client-server applications</h2><h3><a href="/tuto/4.0/manual/how-to-call-a-server-side-function-from-client-side" class="ocsimore_phrasing_link">How to call a server side function from a client side</a></h3><h3><a href="/tuto/4.0/manual/how-to-make-the-client-side-program-get-an-html-element-from-the-server-and-insert-it-in-the-page" class="ocsimore_phrasing_link">How to make the client side program get an HTML element from the server and insert it in the page</a></h3><h3><a href="/tuto/4.0/manual/how-to-attach-ocaml-values-to-the-html-nodes-sent-to-the-client" class="ocsimore_phrasing_link">How to attach OCaml values to the HTML nodes sent to the client</a></h3><h3><a href="/tuto/4.0/manual/how-to-iterate-on-all-sessions-for-one-user-or-all-tabs" class="ocsimore_phrasing_link">How to iterate on all sessions for one user, or all tabs</a></h3><h3><a href="/tuto/4.0/manual/how-to-implement-a-notification-system" class="ocsimore_phrasing_link">How to implement a notification system</a></h3><h3><a href="/tuto/4.0/manual/how-to-send-a-file-to-server-without-stopping-the-client-process" class="ocsimore_phrasing_link">How to send a file to server without stopping the client process</a></h3><h3><a href="/tuto/4.0/manual/how-to-detect-on-client-side-that-the-server-side-state-for-the-process-is-closed" class="ocsimore_phrasing_link">How to detect on client side that the server side state for the process is closed</a></h3><h2> Database</h2><h3><a href="/tuto/4.0/manual/how-to-use-a-database-with-eliom" class="ocsimore_phrasing_link">How to use a database with Eliom</a></h3><h2> Eliom Server side</h2><h3><a href="/tuto/4.0/manual/how-do-i-create-a-cryptographically-safe-identifier" class="ocsimore_phrasing_link">How do I create a Cryptographically safe identifier</a></h3><h3><a href="/tuto/4.0/manual/how-can-i-extend-the-configuration-file-parsing-with-application-specific-entry" class="ocsimore_phrasing_link">How can I extend the configuration file parsing with applicaiton-specific entry</a></h3></div></nav></div></div><button id="reason">Switch to </button><div class="twocols"><div class="leftcol"><div class="how-versions"><input id="how-versions-toggle" type="checkbox"/><label for="how-versions-toggle" class="how-versions-current">Version 4.0</label><div class="how-versions-all"><a href="/tuto/dev/manual/reactivemediaplayer">dev</a><a href="/tuto/6.2/manual/reactivemediaplayer">6.2</a><a href="/tuto/6.1/manual/reactivemediaplayer">6.1</a><a href="/tuto/6.0/manual/reactivemediaplayer">6.0</a><a href="/tuto/5.0/manual/reactivemediaplayer">5.0</a><a href="/tuto/4.2/manual/reactivemediaplayer">4.2</a><a href="/tuto/4.1/manual/reactivemediaplayer">4.1</a><span class="how-versions-all-current">4.0</span><a href="/tuto/3.0/manual/reactivemediaplayer">3.0</a><a href="/tuto/2.2/manual/reactivemediaplayer">2.2</a><a href="/tuto/2.0/manual/reactivemediaplayer">2.0</a></div></div><form id="search"><input name="q" id="q" placeholder="search ..."/><button>Search</button></form><div class="how-doctree"><h1> Tutorial: Your first application</h1><h2><a href="/tuto/4.0/manual/intro" class="ocsimore_phrasing_link">Introduction. Ocsigen: the different projects</a></h2><h2><a href="/tuto/4.0/manual/application" class="ocsimore_phrasing_link">Client/server application</a></h2><h2><a href="/tuto/4.0/manual/interaction" class="ocsimore_phrasing_link">Service based Web programming</a></h2><h2><a href="/tuto/4.0/manual/misc" class="ocsimore_phrasing_link">Miscellaneous features</a></h2><h1> Examples: Learning by example</h1><h2><a href="/tuto/4.0/manual/chat" class="ocsimore_phrasing_link">Chat</a></h2><h1> Mini-tutorials: Some little examples</h1><h2><a href="/tuto/4.0/manual/basicwebsite" class="ocsimore_phrasing_link">A basic Web site in OCaml</a></h2><h2><a href="/tuto/4.0/manual/tutowidgets" class="ocsimore_phrasing_link">Eliom apps basics: writing client server widgets</a></h2><h2><a href="/tuto/4.0/manual/macaque" class="ocsimore_phrasing_link">MaCaQue: SQL queries</a></h2><h2><a href="/tuto/4.0/manual/custom-conf" class="ocsimore_phrasing_link">Custom configuration</a></h2><h2><a href="/tuto/4.0/manual/ocsipersist" class="ocsimore_phrasing_link">Light database</a></h2><h2><a href="/tuto/4.0/manual/pictures" class="ocsimore_phrasing_link">Download pictures</a></h2><h2><a href="/tuto/4.0/manual/music" class="ocsimore_phrasing_link">Playing music</a></h2><h2><a href="/tuto/4.0/manual/reactivemediaplayer" class="ocsimore_phrasing_link">Reactive media player</a></h2><h2><a href="/tuto/4.0/manual/hash-password" class="ocsimore_phrasing_link">Protecting passwords</a></h2><h2><a href="/tuto/4.0/manual/rest" class="ocsimore_phrasing_link">RESTful JSON API</a></h2><h1 class="howto"> HOW-TO</h1><h2> My first steps with Ocsigen</h2><h3><a href="/tuto/4.0/manual/how-to-install-ocsigen" class="ocsimore_phrasing_link">How to install Ocsigen</a></h3><h3><a href="/tuto/4.0/manual/how-to-make-hello-world-in-ocsigen" class="ocsimore_phrasing_link">How to make &quot;hello world&quot; in Ocsigen</a></h3><h3><a href="/tuto/4.0/manual/how-to-compile-my-ocsigen-pages" class="ocsimore_phrasing_link">How to compile my Ocsigen pages</a></h3><h3><a href="/tuto/4.0/manual/how-to-configure-and-launch-the-ocsigen-server" class="ocsimore_phrasing_link">How to configure and launch the Ocsigen Server</a></h3><h3><a href="/tuto/4.0/manual/how-does-a-page-s-source-code-look" class="ocsimore_phrasing_link">How does a client-server app source code look like?</a></h3><h2> How to put some elements in my page ?</h2><h3><a href="/tuto/4.0/manual/how-to-make-page-a-skeleton" class="ocsimore_phrasing_link">How to make a page skeleton</a></h3><h3><a href="/tuto/4.0/manual/how-to-use-get-parameters-or-parameters-in-the-url" class="ocsimore_phrasing_link">How to use GET parameters (parameters in the URL)</a></h3><h3><a href="/tuto/4.0/manual/how-to-add-css-stylesheet" class="ocsimore_phrasing_link">How to add CSS stylesheet</a></h3><h3><a href="/tuto/4.0/manual/how-to-add-a-javascript-script" class="ocsimore_phrasing_link">How to add a Javascript script</a></h3><h3><a href="/tuto/4.0/manual/how-to-add-a-favicon" class="ocsimore_phrasing_link">How to add a Favicon</a></h3><h3><a href="/tuto/4.0/manual/how-to-add-a-div" class="ocsimore_phrasing_link">How to add a div</a></h3><h3><a href="/tuto/4.0/manual/how-to-add-a-list" class="ocsimore_phrasing_link">How to add lists in pages?</a></h3><h3><a href="/tuto/4.0/manual/how-to-add-an-image" class="ocsimore_phrasing_link">How to add an image</a></h3><h3><a href="/tuto/4.0/manual/how-to-write-titles-and-paragraphs" class="ocsimore_phrasing_link">How to write titles and paragraphs</a></h3><h3><a href="/tuto/4.0/manual/how-to-set-and-id-classes-or-other-attributes-to-html-elements" class="ocsimore_phrasing_link">How to set and id, classes or other attributes to HTML elements</a></h3><h3><a href="/tuto/4.0/manual/how-to-add-a-select-or-other-form-element" class="ocsimore_phrasing_link">How to add select (or other form element)</a></h3><h3><a href="/tuto/4.0/manual/how-to-insert-raw-form-elements-not-belonging-to-a-form-towards-a-service" class="ocsimore_phrasing_link">How to insert &quot;raw&quot; form elements (not belonging to a form towards a service)</a></h3><h3><a href="/tuto/4.0/manual/how-to-make-responsive-css" class="ocsimore_phrasing_link">How to make responsive CSS</a></h3><h2> Services</h2><h3><a href="/tuto/4.0/manual/how-to-do-links-to-other-pages" class="ocsimore_phrasing_link">How to do links to other pages</a></h3><h3><a href="/tuto/4.0/manual/how-to-write-forms" class="ocsimore_phrasing_link">How to write forms</a></h3><h3><a href="/tuto/4.0/manual/how-to-register-a-service-that-decides-itself-what-to-send" class="ocsimore_phrasing_link">How to register a service that decides itself what to send</a></h3><h3><a href="/tuto/4.0/manual/how-to-create-link-to-a-current-page-without-knowing-its-url" class="ocsimore_phrasing_link">How to create link to a current page (without knowing its URL)</a></h3><h3><a href="/tuto/4.0/manual/how-to-create-form-wizard-sequence-of-pages-depending-on-data-entered-on-previous-ones" class="ocsimore_phrasing_link">How to create form wizard (sequence of pages depending on data entered on previous ones)</a></h3><h3><a href="/tuto/4.0/manual/how-to-write-a-json-service" class="ocsimore_phrasing_link">How to write a JSON service</a></h3><h3><a href="/tuto/4.0/manual/how-to-send-file-download" class="ocsimore_phrasing_link">How to send a file (download)</a></h3><h3><a href="/tuto/4.0/manual/how-to-send-file-upload" class="ocsimore_phrasing_link">How to send a file (upload)</a></h3><h2> Sessions</h2><h3><a href="/tuto/4.0/manual/how-to-register-session-data" class="ocsimore_phrasing_link">How to register session data</a></h3><h2> Js_of_ocaml</h2><h3><a href="/tuto/4.0/manual/how-to-attach-ocaml-values-to-dom-elements" class="ocsimore_phrasing_link">How to attach OCaml values to DOM elements</a></h3><h3><a href="/tuto/4.0/manual/how-to-know-whether-the-browser-window-has-the-focus-or-not" class="ocsimore_phrasing_link">How to know whether the browser window has the focus or not</a></h3><h3><a href="/tuto/4.0/manual/how-to-build-js-object" class="ocsimore_phrasing_link">How to build js object</a></h3><h3><a href="/tuto/4.0/manual/how-to-stop-default-behaviour-of-events" class="ocsimore_phrasing_link">How to stop default behaviour of events</a></h3><h3><a href="/tuto/4.0/manual/how-to-call-an-ocaml-function-from-js-code" class="ocsimore_phrasing_link">Howt to call an OCaml function from js code</a></h3><h2> Eliom client-server applications</h2><h3><a href="/tuto/4.0/manual/how-to-call-a-server-side-function-from-client-side" class="ocsimore_phrasing_link">How to call a server side function from a client side</a></h3><h3><a href="/tuto/4.0/manual/how-to-make-the-client-side-program-get-an-html-element-from-the-server-and-insert-it-in-the-page" class="ocsimore_phrasing_link">How to make the client side program get an HTML element from the server and insert it in the page</a></h3><h3><a href="/tuto/4.0/manual/how-to-attach-ocaml-values-to-the-html-nodes-sent-to-the-client" class="ocsimore_phrasing_link">How to attach OCaml values to the HTML nodes sent to the client</a></h3><h3><a href="/tuto/4.0/manual/how-to-iterate-on-all-sessions-for-one-user-or-all-tabs" class="ocsimore_phrasing_link">How to iterate on all sessions for one user, or all tabs</a></h3><h3><a href="/tuto/4.0/manual/how-to-implement-a-notification-system" class="ocsimore_phrasing_link">How to implement a notification system</a></h3><h3><a href="/tuto/4.0/manual/how-to-send-a-file-to-server-without-stopping-the-client-process" class="ocsimore_phrasing_link">How to send a file to server without stopping the client process</a></h3><h3><a href="/tuto/4.0/manual/how-to-detect-on-client-side-that-the-server-side-state-for-the-process-is-closed" class="ocsimore_phrasing_link">How to detect on client side that the server side state for the process is closed</a></h3><h2> Database</h2><h3><a href="/tuto/4.0/manual/how-to-use-a-database-with-eliom" class="ocsimore_phrasing_link">How to use a database with Eliom</a></h3><h2> Eliom Server side</h2><h3><a href="/tuto/4.0/manual/how-do-i-create-a-cryptographically-safe-identifier" class="ocsimore_phrasing_link">How do I create a Cryptographically safe identifier</a></h3><h3><a href="/tuto/4.0/manual/how-can-i-extend-the-configuration-file-parsing-with-application-specific-entry" class="ocsimore_phrasing_link">How can I extend the configuration file parsing with applicaiton-specific entry</a></h3></div></div><div class="rightcol"><h1>Reactive Media Player</h1><p>You should read the <a href="/tuto/manual/music" class="ocsimore_phrasing_link">Playing Music</a> tutorial before this one.
</p><p>Since version 4, Eliom embeds React library in order to use reactive
html element like nodes and attributes. The documentation for the the React library itself can be found <a href="http://erratique.ch/logiciel/react" class="ocsimore_phrasing_link">here</a>.
</p>The final eliom code is available
<a href="https://github.com/ocsigen/tutorial/tree/master/files/tutorial/chapter3/reactive_media_player/reactive_media_player.eliom" class="ocsimore_phrasing_link">for download</a>.<h2 id="basics"> Basics <a class="backref" href="#basics">&#182;</a></h2><p>A reactive element, or more generally a reactive value, depends on the
current value of a signal. For instance :
</p><pre class=""><code class="language-ocaml translatable">{server{

open Eliom_content

let s, set_s = React.S.create 0 (* signal creation *)

let example_div =
  C.node {{R.node (React.S.map (
    fun s_value -&gt;
      Html5.D.(div [pcdata (string_of_int s_value)]
    )) s)}}

let incr_button =
  Html5.D.(string_input ~input_type:`Submit () ~value:&quot;Increment&quot;
    ~a:[a_onclick (fun _ -&gt; set_s (succ (React.S.value s)))])
}}</code></pre><p>The signal <span class="teletype">s</span> carries an int value initialized at 0 and <span class="teletype">set_s</span> is
the update function generating an occurence of the signal.
</p><p>The <span class="teletype">example_div</span> value is a div containing a string and all of this depends
of the value of s.
</p><p>The magic part : we never have to write explicitly the update of
the div. Its behavior is described in it's own code and not in the
code of the button.
</p><aside class="concept"><header><h5><span class="concept_prefix">Concept: </span>Reactive server node</h5></header><p><span class="teletype">C.node</span> takes a reactive client node and brings it to the server side</p></aside><aside class="concept"><header><h5><span class="concept_prefix">Concept: </span>Step semantics</h5></header><p><strong>Warning</strong> If you didn't read the React semantics, be aware of this:
a step occurence of a signal <span class="teletype">s</span> happens when the update function is called
on the signal or on a other signal <span class="teletype">s'</span> which <span class="teletype">s</span> depends on. 
But moreover, this update call must at least <strong>modify</strong>
the signal current value, otherwise it's not a step.
</p><p>This can be seen when there are side effects (like print) in the code
of functions mapped to the signal. If the update function doesn't modify
the signal value, the printing doesn't happen.
</p><p>The test equality function of a signal can be set in the <span class="teletype">eq</span> optional parameters
of React.S functions producing a signal (like <span class="teletype">create</span>).</p></aside><h2 id="frp_medial_player"> Functional Reactive Media Player <a class="backref" href="#frp_medial_player">&#182;</a></h2><p>This part explains how to create a simple media player like in
<a href="/tuto/manual/music" class="ocsimore_phrasing_link">Playing Music</a> tutorial but with custom
controls. We are going to write those in
<a href="http://en.wikipedia.org/wiki/Functional_reactive_programming" class="ocsimore_phrasing_link">FRP (Functionnal Reactive
Programming)</a> way.
</p><p>In order to show a short tutorial, we only create three controls:
Play, Pause and Seek/Progress bar.  So, let's write the corresponding
type:
</p><pre class=""><code class="language-ocaml translatable">{shared{
open Eliom_content
}}
{client{

type media_action = Play | Pause | Seek of float
let media_s, set_media_s = React.S.create Pause

}}</code></pre><p>Each html element emits a signal value corresponding to it's action.
It's enough to create our Play and Pause inputs.
</p><pre class=""><code class="language-ocaml translatable">{server{
		
let pause_button () =
  D.(button ~button_type:`Button
    ~a:[a_onclick {{ fun _ -&gt; set_media_s Pause }}] [pcdata &quot;Pause&quot;])

let play_button () =
  D.(button ~button_type:`Button
    ~a:[a_onclick {{ fun _ -&gt; set_media_s Play }}] [pcdata &quot;Play&quot;])

}}</code></pre><aside class="concept"><header><h5><span class="concept_prefix">Concept: </span>Abstract the Js events</h5></header><p>The other nice part of FRP is that we can abstract javascript
events and use only the signals.
The Js event handler is only a function raising a signal.</p></aside><p>To use our buttons, we now create a media (audio or video) html element on the server
side.
</p><pre class=""><code class="language-ocaml translatable">{server{
let media_uri = Html5.D.make_uri
  ~service:(Eliom_service.static_dir ()) [&quot;example.mp3&quot;]
		(* Assuming that you add a file 'example.mp3' in the
			static directory of your project *)

	
let media_tag () =
  let media = D.(audio ~src:(media_uri)[pcdata &quot;alt&quot;]) in
  let _ = {unit{
    Lwt.async (fun () -&gt;
      let media = To_dom.of_audio %media in
      Lwt_react.S.keep (React.S.map (function
        | Play -&gt; media##play ()
        | Pause -&gt; media##pause ()
        | Seek f -&gt; media##currentTime &lt;- (f /. 100. *. media##duration))
        media_s);
      Lwt_js_events.timeupdates media (ontimeupdate_emit media);
      )}}
  in media

}}</code></pre><p>The code in <span class="teletype"> {unit{...}} </span> is on the client part. It's an asynchronous
Lwt thread that executes the code inside: mapping a
function <span class="teletype">media_action -&gt; unit</span> to the signal <span class="teletype">media_s</span>.
</p><aside class="concept"><header><h5><span class="concept_prefix">Concept: </span>Playing video</h5></header><p>The code to play a video is exactly the same except that you must
replace <span class="teletype">audio</span> tag by <span class="teletype">video</span> tag. But be careful, some
browsers are not compatible with many formats.</p></aside><aside class="concept"><header><h5><span class="concept_prefix">Concept: </span>Create local elements outside the Html value</h5></header><p>If you don't want to create a global element as in
<a href="/tuto/manual/music" class="ocsimore_phrasing_link">Playing Music</a>, and you don't even want to
create it locally in the html value, you can also create a function
which builds the element. Here it's <span class="teletype">media_tag</span></p></aside><pre class=""><code class="language-ocaml translatable">{server{
module React_Player_app =
  Eliom_registration.App (
  struct
    let application_name = &quot;react_player&quot;
  end)

let media_service =
  Eliom_service.App.service ~path:[] ~get_params:Eliom_parameter.unit ()

let () =
  React_Player_app.register
    ~service:media_service
    (fun name () -&gt;
      Lwt.return D.(
        Eliom_tools.D.html ~title:&quot;Media&quot; ~css:[]
          (body [
            h2 [pcdata &quot;Media&quot;];
            media_tag ();
            div [
              play_button (); pause_button ()]])))
}}</code></pre><p>Now you should have an html node with an audio tag and two buttons play and
pause.  The progress bar is slightly harder to understand, but thanks
to FRP, very easy to write.  It's basically an <span class="teletype">input</span> with
<span class="teletype">range</span> type. In our program, the progress bar must emit the
signal <span class="teletype">media_s</span> with the value <span class="teletype">Seek f</span> at input handling.
Then, it must evolve during the progression of the media (we need an
other signal).  To conclude, we must check that the display (the
value) of the progress bar is not modified when the user is seeking.
</p><pre class=""><code class="language-ocaml translatable">{client{

let progress_s, set_progress_s = React.S.create (0., 0.)
let unblock_s, set_unblock_s = React.S.create true

}}	


{server{
  
let progress_bar () =
  let progress_value = {float React.signal{ React.S.map (fun (time, duration) -&gt;
    if duration = 0. then 0. else time /. duration *. 100.) progress_s }} in
  let attrs = D.([
    a_input_min 0.;
    a_input_max 100.;
    a_onmousedown {{fun _ -&gt; set_unblock_s false}};
    a_onmouseup {{fun _ -&gt; set_unblock_s true}};
    C.attr {{R.a_value (React.S.map (Printf.sprintf &quot;%0.f&quot;)
                          (React.S.on unblock_s 0. %progress_value))}};])
  in
  let d_input = D.(float_input ~input_type:`Range () ~value:0. ~a:attrs) in
  let _ = {unit{
    Lwt.async (fun () -&gt;
      let d_input = To_dom.of_input %d_input in
      Lwt_js_events.inputs d_input (fun _ _ -&gt;
        set_media_s (Seek (Js.parseFloat (d_input##value))))
    )}}
  in d_input

}}</code></pre><aside class="concept"><header><h5><span class="concept_prefix">Concept: </span>Reactive attributes and React.S.on</h5></header><p>The function <span class="teletype">R.a_value</span> is a reactive attribute
value. <span class="teletype">React.S.on c d s</span> is equal to <span class="teletype">s</span> when <span class="teletype">c</span> is true, 
unless it's equal to <span class="teletype">d</span> (in case <span class="teletype">c</span> has never been true). Which
means we update the attribute value of our input only if unblock is true.</p></aside><p>To end this tutorial, you can add a <span class="teletype">progress_bar ()</span> call inside
the div containing play and pause. We also need a mechanism which emits
the <span class="teletype">progress_s</span> signal.
</p><pre class=""><code class="language-ocaml translatable">{client{

let ontimeupdate_emit media _ _ =
  set_progress_s (media##currentTime, media##duration);
  Lwt.return ()

}}</code></pre><p>Set the eventhandler on <span class="teletype">timeupdate</span> :
</p><pre class=""><code class="language-ocaml translatable">let media_tag () =
  let media = D.(audio ~src:(media_uri)[pcdata &quot;alt&quot;]) in
  let _ = {unit{
    Lwt.async (fun () -&gt;
      let media = To_dom.of_audio %media in
      Lwt_react.S.keep (React.S.map (function
        | Play -&gt; media##play ()
        | Pause -&gt; media##pause ()
        | Seek f -&gt; media##currentTime &lt;- (f /. 100. *. media##duration))
        media_s);
				(* Emit progress_s when timeupdate is raised *)
      Lwt_js_events.timeupdates media
        (fun _ _ -&gt; set_progress_s (media##currentTime, media##duration))
      )}}
  in media</code></pre><h4>Exercises</h4><ul><li> Add a control to set the volume
</li><li> Add an <span class="teletype">Eliom_bus</span> to control several clients
</li></ul></div></div></div></body></html>
